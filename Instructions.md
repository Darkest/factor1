# Инструкция по сборке и запуску

Для сборки использовать команду Gradle - build\
Для запуска использовать команду Gradle - run

Приложение использует файл src\main\resources\application.conf 
для настройки поключения к БД. При необходимости использования внешней БД необходимо указать 
новые параметры подключения и добавить путь к драйверу выбранной БД в classpath. \
Данные изменения необходимо делать до сборки проекта, либо пользоваться способом описанным ниже.

Приложение поддерживает следующие параметры запуска:
 - --ac <путь к файлу с настройкой подключения к бд> - позволяет использовать внешний файл настроек подключения к БД взамен встроенного
 - --users <путь к файлу, содержащему список пользователей с указанием из текущего местоположения> - при запуске приложения данные пользователи будет автоматически загружены в БД
 - --locs <путь к файлу, содержащему список геолокаций с указанием радиуса их действия> - при запуске приложения данные геолокации будут автоматически загружены в БД 

При старте приложение автоматически создает схему БД, необходимую ему для работы. 
В случае если таблицы или другие объекты уже существвуют, то будет выведено предупреждение и приложение будет осуществлять работу с существующими объектами.
Правильная работа в таком случае НЕ ГАРАНТИРУЕТСЯ! 
Далее в БД загружаются данные, содержащиеся в файлах указанных для ключей --users и --locs
После этого запускается finagle сервер

Приложение предоставляет 3 варианта запроса:
- Проверка нахождения пользователя рядом с указанной геопозицией
  - Пример запроса: 
`POST /userInLocation HTTP/1.1
                Host: localhost:9111
                Content-Type: application/json
                Cache-Control: no-cache
                Postman-Token: 89edae8d-5dc6-4f5a-889b-06bb35576de0
                	{
                		"id":112,
                		"loc":{
                			"lat":34.5,
                			"lon":-101.3
                			}
                	}`
  - Пример ответа:`{
                      "user": {
                          "id": 112,
                          "loc": {
                              "lat": 33.015023,
                              "lon": -117.087641
                          }
                      },
                      "location": {
                          "lat": 34.5,
                          "lon": -101.3
                      },
                      "status": false
                  }`
- Обновление текущего местоположения пользователя(или его добавление, при отсутствии пользователя с указанным id)
  - Привер запроса: `PUT /updateLocation HTTP/1.1
                    Host: localhost:9111
                    Content-Type: application/json
                    Cache-Control: no-cache
                    Postman-Token: b60fdc20-2406-47ad-92e1-c79a0c203665
                    	{
                    		"id":112,
                    		"loc":{
                    			"lat":34.5,
                    			"lon":-101.3
                    			}
                    	}`
  - Пример ответа: `{
                       "id": 112,
                       "loc": {
                           "lat": 34.5,
                           "lon": -101.3
                       }
                   }`
- Получение количества пользователей в заданной геолокации
  - Пример запроса: `POST /usersCountInLocation HTTP/1.1
                    Host: localhost:9111
                    Content-Type: application/json
                    Cache-Control: no-cache
                    Postman-Token: c826ab0f-17ae-4ba9-be92-707e4d3a8ce0
                    {
                    "lat":34.5,
                    "lon":-101.3
                    }`
  - Пример ответа: `231`